<!DOCTYPE html>
<html>
<head>
<title>Config</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<style>
    .hidden {
        display:none;
    }
    .shown {
        display:block;
    }

    body {
        font-family:'Arial',sans-serif;
        font-weight:bold;
        margin-left: 20px;
    }
</style>

<script type="text/javascript">

    var device_name;
    var browser_interval1;

    var web_socket;

    function checkBrowser()
    {
        document.getElementById("browser_status").innerHTML =
            location.host + " " +
            window.navigator.onLine ? "onLine" : "not onLine";
    }


    function startConfig()
    {
        browser_interval = setInterval(checkBrowser,200);
        var url = 'ws://' + location.host + ':81';

        web_socket = new WebSocket(url);

        web_socket.onopen = function(openEvent) {
            console.log("WebSocket OPEN: " + JSON.stringify(openEvent, null, 4));
        };
        web_socket.onclose = function (closeEvent) {
            console.log("WebSocket CLOSE: " + JSON.stringify(closeEvent, null, 4));
        };
        web_socket.onerror = function (errorEvent) {
            console.log("WebSocket ERROR: " + JSON.stringify(errorEvent, null, 4));
        };
        web_socket.onmessage = function (messageEvent)
        {
            var wsMsg = messageEvent.data;
            console.log("WebSocket MESSAGE: " + wsMsg);
            if (wsMsg == "HELLO")
            {
                web_socket.send(JSON.stringify({cmd:"get_config_list"}));
            }
            else
            {
                var obj = JSON.parse(wsMsg);
                if (obj)
                {
                    if (obj.config_list)
                    {
                        console.log("config_list=",config_list);
                    }
                    else
                    {
                        console.log("Unknown json object " + obj);
                    }
                }
                else
                    console.log("Could not parse json: " + wsMsg);

            }
        };
    }


    window.onload = startConfig;

</script>
</head>

<body>
<div id='status'>
    Browser: <span id='browser_status'>browser_status</span><br>
</div>

<br><br>

<div id="config_list">
    config list
    <br>
</div>

</body>
</html>
